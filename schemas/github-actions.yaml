# os grupos não refletem na estrutura do yaml, servem apenas para separar o conteúdo em tela, ou seja, os jobs devem ser um field do tipo lista de objetos
# eu tenho uma rule em cada field, se necessario, eu valido apenas essas regras durante o preenchimento. Quando o utlim campo do agrupamento for preenchido devo
# validar as regras do agrupamento para entender a relação entre o fields do grupo. Um mensagem deve ser enviada dizendo que esse é o ultimo campo a ser preenchido pelo usuario
#  assim eele pode preencher na ordem que bem entender

# ao final de todos os agrupamentos, executo as regras do arquivo que servem para validar a relacao entre os agrupamentos


name: GitHub Actions

groups:
  on_group:
    label: ON
    description: Define o evento que disparará a action.
    fields:
      on:
        type: list
        itemType: string
        required: true
        help: Lista de eventos que irão disparar a action
        defaultValues: [create, delete, pull, push, pull-request, deployment]
      branches:
        type: list
        itemType: string
        required: true
        help: Lista de branches onde o push irá disparar a action.
  jobs_group:
    label: Jobs
    description: Define os jobs da action.
    fields:
      jobs:
        type: list
        itemType: object
        fields:
          nameable:
            type: object
            nameableKey: true
            fields:  
              runs-on:
                type: string
                defaultValues: [example1, example2]
                required: true
                help: Define o sistema operacional usado.
              steps:
                type: list
                required: true
                help: Lista de etapas executadas no job.
                itemType: object
                fields:
                  name:
                    type: string
                    help: Nome da etapa.
                    repeatable: true
                  run:
                    type: string
                    help: Comando a ser executado.
                    repeatable: true
rules:
  required-jobs:
    description: Ao menos um job é necessário
    condition: $count(groups.jobs_group.fields.jobs) > 0
    error: Ao menos um job é necessário
  required-events:
    description: Obriga o preenchimento do field 'ON'.
    condition: $count(groups.on_group.fields.on) > 0
    error: Ao menos um evento é necessário para inicializar a action. 'ON' está vazio